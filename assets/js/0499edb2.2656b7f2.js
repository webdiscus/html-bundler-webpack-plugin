"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3250],{4433:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"Options/PluginOptions/js","title":"js (options for JS)","description":"Option: js","source":"@site/docs/Options/PluginOptions/js.mdx","sourceDirName":"Options/PluginOptions","slug":"/Options/PluginOptions/js","permalink":"/html-bundler-webpack-plugin/Options/PluginOptions/js","draft":false,"unlisted":false,"editUrl":"https://github.com/webdiscus/html-bundler-webpack-plugin/tree/master/docs/Options/PluginOptions/js.mdx","tags":[],"version":"current","sidebarPosition":40,"frontMatter":{"sidebar_position":40,"title":"js (options for JS)"},"sidebar":"docsSidebar","previous":{"title":"data (for templates)","permalink":"/html-bundler-webpack-plugin/Options/PluginOptions/data"},"next":{"title":"css (options for CSS)","permalink":"/html-bundler-webpack-plugin/Options/PluginOptions/css"}}');var t=i(4848),l=i(8453);const r={sidebar_position:40,title:"js (options for JS)"},c="Options for JS",o={},a=[];function d(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",br:"br",code:"code",h1:"h1",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"options-for-js",children:"Options for JS"})}),"\n",(0,t.jsxs)(n.p,{children:["Option: ",(0,t.jsx)(n.code,{children:"js"})]}),"\n",(0,t.jsx)(n.p,{children:"Type:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"type JsOptions = {\n  filename?: FilenameTemplate;\n  chunkFilename?: FilenameTemplate;\n  outputPath?: string;\n  inline?: 'auto' | boolean | JsInlineOptions;\n};\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"type JsInlineOptions = {\n  enabled?: 'auto' | boolean;\n  chunk?: RegExp | Array<RegExp>;\n  source?: RegExp | Array<RegExp>;\n  attributeFilter?: (props: {\n    attribute: string;\n    value: string;\n    attributes: { [attributeName: string]: string };\n  }) => boolean | void;\n};\n"})}),"\n",(0,t.jsx)(n.p,{children:"Default properties:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"{\n  filename: '[name].js',\n  chunkFilename: '[id].js',\n  outputPath: null,\n  inline: false,\n}\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"filename"})," - an output filename of JavaScript. Details see by ",(0,t.jsx)(n.a,{href:"#option-filename",children:"filename option"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"chunkFilename"})," - an output filename of non-initial chunk files. Details see by ",(0,t.jsx)(n.a,{href:"https://webpack.js.org/configuration/output/#outputchunkfilename",children:"chunkFilename"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"outputPath"})," - an output path of JavaScript. Details see by ",(0,t.jsx)(n.a,{href:"#option-outputpath",children:"outputPath option"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"inline"})," property allows to inline compiled JavaScript chunks into HTML."]}),"\n",(0,t.jsxs)(n.p,{children:["If ",(0,t.jsx)(n.code,{children:"inline"})," is ",(0,t.jsx)(n.code,{children:"'auto'"})," or ",(0,t.jsx)(n.code,{children:"boolean"}),", available values:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"false"})," - stores JavaScript in an output file (",(0,t.jsx)(n.strong,{children:"defaults"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"true"})," - adds JavaScript to the DOM by injecting a ",(0,t.jsx)(n.code,{children:"<script>"})," tag"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"'auto'"})," - in ",(0,t.jsx)(n.code,{children:"development"})," mode - adds to DOM, in ",(0,t.jsx)(n.code,{children:"production"})," mode - stores as a file"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["If ",(0,t.jsx)(n.code,{children:"inline"})," is an ",(0,t.jsx)(n.code,{children:"object"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"enabled"})," - has the values: ",(0,t.jsx)(n.code,{children:"true"})," (",(0,t.jsx)(n.strong,{children:"defaults"}),"), ",(0,t.jsx)(n.code,{children:"false"})," or ",(0,t.jsx)(n.code,{children:"'auto'"}),", description see above,",(0,t.jsx)(n.br,{}),"\n","if the ",(0,t.jsx)(n.code,{children:"enabled"})," is undefined, then using the ",(0,t.jsx)(n.code,{children:"inline"})," as the ",(0,t.jsx)(n.code,{children:"object"}),", the value is ",(0,t.jsx)(n.code,{children:"true"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"chunk"})," - inline the single chunk when output chunk filename matches a regular expression(s)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"source"})," - inline all chunks when source filename matches a regular expression(s)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"attributeFilter"})," - filter function to keep/remove attributes for inlined script tag. If undefined, all attributes will be removed.",(0,t.jsx)(n.br,{}),"\n","Destructed arguments:"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"attribute"})," - attribute name"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"value"})," - attribute value"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"attributes"})," - all attributes of the script tag"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Return:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"true"})," - keep the attribute in the inlined script tag"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"false"})," or ",(0,t.jsx)(n.code,{children:"undefined"})," - remove the attribute"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["You can use both the ",(0,t.jsx)(n.code,{children:"chunk"})," and the ",(0,t.jsx)(n.code,{children:"source"})," options,\nthen there will be inlined chunks matching regular expressions with ",(0,t.jsx)(n.code,{children:"OR"})," logic."]}),"\n",(0,t.jsxs)(n.p,{children:["For example, there is used the ",(0,t.jsx)(n.code,{children:"optimization.splitChunks"})," and we want to inline only the small webpack runtime chunk\nbut other JS chunks of the same split ",(0,t.jsx)(n.code,{children:"app.js"})," file should be saved to chunk files, then use the following inline option:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"js: {\n  filename: 'js/[name].[contenthash:8].js',\n  inline: {\n    chunk: [/runtime.+[.]js/],\n  },\n},\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Then the ",(0,t.jsx)(n.code,{children:"app.js"})," file will be split to many output chunks in the ",(0,t.jsx)(n.code,{children:"dist/"})," directory, e.g.:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"js/325.xxxxxxxx.js  -> save as file\njs/545.xxxxxxxx.js  -> save as file\njs/app.xxxxxxxx.js  -> save as file\nruntime.xxxxxxxx.js        -> inline the chunk into HTML and NOT save as file\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The single ",(0,t.jsx)(n.code,{children:"runtime.xxxxxxxx.js"})," chunk will be injected into HTML, other chunks will be saved to output directory."]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"[!NOTE]"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"filename"})," and ",(0,t.jsx)(n.code,{children:"chunkFilename"})," options are the same as in Webpack ",(0,t.jsx)(n.code,{children:"output"})," options, just defined in one place along with other relevant plugin options.\nYou don't need to define them in the in Webpack ",(0,t.jsx)(n.code,{children:"output"})," options anymore. Keep the config clean & clear."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["To keep some original script tag attributes in the inlined script tag, use the ",(0,t.jsx)(n.code,{children:"attributeFilter"}),".\nFor example, there is a script tag with attributes:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-html",children:'<script id="js-main" src="./main.js" defer><\/script>\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Use the ",(0,t.jsx)(n.code,{children:"attributeFilter"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"new HtmlBundlerPlugin({\n  // ...\n  js: {\n    inline: {\n      attributeFilter: ({ attributes, attribute, value }) => {\n        if (attribute === 'id') return true;\n      },\n    },\n  },\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The inlined tag contains the ",(0,t.jsx)(n.code,{children:"id"})," attribute, but the ",(0,t.jsx)(n.code,{children:"src"})," and ",(0,t.jsx)(n.code,{children:"defer"})," are removed:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-html",children:'<script id="js-main">\n  // inlined JavaScript code\n<\/script>\n'})}),"\n",(0,t.jsxs)(n.p,{children:["All source script files specified in ",(0,t.jsx)(n.code,{children:'<script src="...">'})," are automatically resolved,\nand JS will be extracted to output file. The source filename will be replaced with the output filename."]}),"\n",(0,t.jsx)(n.p,{children:"For example:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-html",children:'<script src="./main.js"><\/script>\n'})}),"\n",(0,t.jsxs)(n.p,{children:["The default JS output filename is ",(0,t.jsx)(n.code,{children:"[name].js"}),".\nYou can specify your own filename using ",(0,t.jsx)(n.a,{href:"https://webpack.js.org/configuration/output/#outputfilename",children:"webpack filename substitutions"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"const HtmlBundlerPlugin = require('html-bundler-webpack-plugin');\nmodule.exports = {\n  plugins: [\n    new HtmlBundlerPlugin({\n      js: {\n        filename: 'js/[name].[contenthash:8].js',\n      },\n    }),\n  ],\n};\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"[name]"})," is the base filename script.\nFor example, if source file is ",(0,t.jsx)(n.code,{children:"main.js"}),", then output filename will be ",(0,t.jsx)(n.code,{children:"js/main.1234abcd.js"}),".",(0,t.jsx)(n.br,{}),"\n","If you want to have a different output filename, you can use the ",(0,t.jsx)(n.code,{children:"filename"})," options as the ",(0,t.jsx)(n.a,{href:"https://webpack.js.org/configuration/output/#outputfilename",children:"function"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"chunkFilename"})," option only takes effect if you have the ",(0,t.jsx)(n.code,{children:"optimization.splitChunks"})," option."]}),"\n",(0,t.jsx)(n.p,{children:"For example:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"const HtmlBundlerPlugin = require('html-bundler-webpack-plugin');\nmodule.exports = {\n  plugins: [\n    new HtmlBundlerPlugin({\n      entry: {\n        index: 'src/views/index.html',\n      },\n      js: {\n        filename: 'js/[name].[contenthash:8].js',\n        chunkFilename: 'js/[id].[contenthash:8].js',\n      },\n    }),\n  ],\n  optimization: {\n    splitChunks: {\n      cacheGroups: {\n        scripts: {\n          test: /\\.(js|ts)$/, // <= IMPORTANT: split only script files\n          chunks: 'all',\n        },\n      },\n    },\n  },\n};\n"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsxs)(n.p,{children:["Webpack tries to split and concatenate chunks of all files (templates, styles, scripts) into jumbles.\nTherefore, the ",(0,t.jsx)(n.code,{children:"test"})," option ",(0,t.jsx)(n.code,{children:"MUST"})," be specified to match only source JS files, otherwise Webpack will generate ",(0,t.jsx)(n.strong,{children:"invalid output files"}),"."]})}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Also see ",(0,t.jsxs)(n.a,{href:"#recipe-split-chunks-keep-module-name",children:["How to keep package name for split chunks from ",(0,t.jsx)(n.strong,{children:"node_modules"})]}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>c});var s=i(6540);const t={},l=s.createContext(t);function r(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);