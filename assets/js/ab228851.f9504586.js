"use strict";(self.webpackChunkhtml_bundler_docs=self.webpackChunkhtml_bundler_docs||[]).push([[48],{8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>l});var i=t(6540);const s={},r=i.createContext(s);function o(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:n},e.children)}},9187:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>d,frontMatter:()=>o,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"Options/PluginOptions/integrity","title":"integrity","description":"Option: integrity","source":"@site/docs/Options/PluginOptions/integrity.mdx","sourceDirName":"Options/PluginOptions","slug":"/plugin-options-integrity","permalink":"/html-bundler-webpack-plugin/plugin-options-integrity","draft":false,"unlisted":false,"editUrl":"https://github.com/webdiscus/html-bundler-docs-gh/tree/master/docs/Options/PluginOptions/integrity.mdx","tags":[{"inline":true,"label":"HTML","permalink":"/html-bundler-webpack-plugin/tags/html"},{"inline":true,"label":"integrity","permalink":"/html-bundler-webpack-plugin/tags/integrity"},{"inline":true,"label":"css","permalink":"/html-bundler-webpack-plugin/tags/css"},{"inline":true,"label":"js","permalink":"/html-bundler-webpack-plugin/tags/js"}],"version":"current","sidebarPosition":180,"frontMatter":{"sidebar_position":180,"slug":"/plugin-options-integrity","title":"integrity","tags":["HTML","integrity","css","js"]},"sidebar":"docsSidebar","previous":{"title":"renderStage","permalink":"/html-bundler-webpack-plugin/plugin-options-renderStage"},"next":{"title":"minify","permalink":"/html-bundler-webpack-plugin/plugin-options-minify"}}');var s=t(4848),r=t(8453);const o={sidebar_position:180,slug:"/plugin-options-integrity",title:"integrity",tags:["HTML","integrity","css","js"]},l="integrity",c={},h=[{value:"Related hook",id:"related-hook",level:3}];function a(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"integrity",children:"integrity"})}),"\n",(0,s.jsxs)(n.p,{children:["Option: ",(0,s.jsx)(n.code,{children:"integrity"})]}),"\n",(0,s.jsxs)(n.p,{children:["Type: ",(0,s.jsx)(n.code,{children:"'auto'|boolean|IntegrityOptions"})," Default: ",(0,s.jsx)(n.code,{children:"false"})]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity",children:"subresource integrity hash"})," is a cryptographic value of the integrity attribute that used by a browser to verify that the content of an asset has not been manipulated.\nIf the asset has been manipulated, the browser will never load it."]}),"\n",(0,s.jsxs)(n.p,{children:["The Bundler Plugin generates the integrity hashes and adds the integrity attribute to the ",(0,s.jsx)(n.code,{children:"link"})," and ",(0,s.jsx)(n.code,{children:"script"})," tags when generating HTML."]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"No additional plugins required. This plugin computes integrity hashes itself."}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"type IntegrityOptions = {\n  enabled?: 'auto' | boolean;\n  hashFunctions?: HashFunctions | Array<HashFunctions>;\n};\ntype HashFunctions = 'sha256' | 'sha384' | 'sha512';\n"})}),"\n",(0,s.jsxs)(n.p,{children:["If the ",(0,s.jsx)(n.code,{children:"integrity"})," option is an object, then default options are:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"{\n  enabled: 'auto',\n  hashFunctions: 'sha384',\n}\n"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.a,{href:"https://www.w3.org/TR/2016/REC-SRI-20160623/#hash-collision-attacks",children:"W3C recommends"})," using the ",(0,s.jsx)(n.code,{children:"SHA-384"})," hash algorithm."]})}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"integrity"})," or ",(0,s.jsx)(n.code,{children:"integrity.enabled"})," has one of values:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"auto"})," - enable the integrity when Webpack mode is ",(0,s.jsx)(n.code,{children:"production"})," and disable it when mode is ",(0,s.jsx)(n.code,{children:"development"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"true"})," - enable"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"false"})," - disable"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"hashFunctions"})," option can be a string to specify a single hash function name,\nor an array to specify multiple hash functions for compatibility with many browsers."]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.admonition,{type:"warning",children:[(0,s.jsxs)(n.p,{children:["When used the ",(0,s.jsx)(n.code,{children:"integrity"})," option:"]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.a,{href:"#option-js",children:(0,s.jsx)(n.code,{children:"js.filename"})})," and ",(0,s.jsx)(n.a,{href:"#option-css",children:(0,s.jsx)(n.code,{children:"css.filename"})})," options must contain the ",(0,s.jsx)(n.code,{children:"contenthash"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.a,{href:"https://webpack.js.org/configuration/output/#outputcrossoriginloading",children:(0,s.jsx)(n.code,{children:"output.crossOriginLoading"})})," Webpack option must be specified as ",(0,s.jsx)(n.code,{children:"'use-credentials'"})," or ",(0,s.jsx)(n.code,{children:"'anonymous'"}),".\nThe bundler plugin adds the ",(0,s.jsx)(n.code,{children:"crossorigin"})," attribute with the value defined in the ",(0,s.jsx)(n.code,{children:"crossOriginLoading"}),".\nThe ",(0,s.jsx)(n.code,{children:"crossorigin"})," attribute  tells the browser to request the script with CORS enabled, which is necessary because the integrity check fails without CORS."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.a,{href:"https://webpack.js.org/configuration/optimization/#optimizationrealcontenthash",children:(0,s.jsx)(n.code,{children:"optimization.realContentHash"})})," Webpack option must be enabled, by default is enabled in production mode only."]}),"\n"]}),"\n"]}),(0,s.jsxs)(n.p,{children:["This requirement is necessary to avoid the case where the browser tries to load a contents of a file from the local cache since the filename has not changed, but the ",(0,s.jsx)(n.code,{children:"integrity"})," value has changed on the server.\nIn this case, the browser will not load the file because the ",(0,s.jsx)(n.code,{children:"integrity"})," of the cached file computed by the browser will not match the ",(0,s.jsx)(n.code,{children:"integrity"})," attribute computed on the server."]})]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Add the ",(0,s.jsx)(n.code,{children:"integrity"})," option in the Webpack config:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const HtmlBundlerPlugin = require('html-bundler-webpack-plugin');\n\nmodule.exports = {\n  output: {\n    // required for `integrity` to work in the browser\n    crossOriginLoading: 'anonymous',\n  },\n  plugins: [\n    new HtmlBundlerPlugin({\n      entry: {\n        index: 'src/views/index.html', // template where are included link and script tags\n      },\n      js: {\n        filename: '[name].[contenthash:8].js', // the filename must contains a contenthash\n      },\n      css: {\n        filename: '[name].[contenthash:8].js', // the filename must contains a contenthash\n      },\n      integrity: 'auto', // enable in `production`, disable in `development` mode\n    }),\n  ],\n};\n"})}),"\n",(0,s.jsxs)(n.p,{children:["The source HTML template ",(0,s.jsx)(n.em,{children:"src/views/index.html"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'<html>\n  <head>\n    \x3c!-- include source style --\x3e\n    <link href="./style.scss" rel="stylesheet" />\n    \x3c!-- include source script --\x3e\n    <script src="./main.js" defer="defer"><\/script>\n  </head>\n  <body>\n    <h1>Hello World!</h1>\n  </body>\n</html>\n'})}),"\n",(0,s.jsx)(n.p,{children:"The generated HTML contains the integrity hashes:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'<html>\n  <head>\n    <link\n      href="style.1234abcd.css"\n      rel="stylesheet"\n      integrity="sha384-gaDmgJjLpipN1Jmuc98geFnDjVqWn1fixlG0Ab90qFyUIJ4ARXlKBsMGumxTSu7E"\n      crossorigin="anonymous" />\n\n    <script\n      src="main.abcd1234.js"\n      defer="defer"\n      integrity="sha384-E4IoJ3Xutt/6tUVDjvtPwDTTlCfU5oG199UoqWShFCNx6mb4tdpcPLu7sLzNc8Pe"\n      crossorigin="anonymous"><\/script>\n  </head>\n  <body>\n    <h1>Hello World!</h1>\n  </body>\n</html>\n'})}),"\n",(0,s.jsx)(n.h3,{id:"related-hook",children:"Related hook"}),"\n",(0,s.jsxs)(n.p,{children:["See the ",(0,s.jsx)(n.a,{href:"#hook-integrity-hashes",children:(0,s.jsx)(n.code,{children:"integrityHashes"})})," hook."]})]})}function d(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}}}]);