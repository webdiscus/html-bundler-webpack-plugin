"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3756],{24:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>p,frontMatter:()=>i,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"Options/PluginOptions/preprocessor","title":"preprocessor (for templates)","description":"Option: preprocessor\\\\","source":"@site/docs/Options/PluginOptions/preprocessor.mdx","sourceDirName":"Options/PluginOptions","slug":"/Options/PluginOptions/preprocessor","permalink":"/html-bundler-webpack-plugin/Options/PluginOptions/preprocessor","draft":false,"unlisted":false,"editUrl":"https://github.com/webdiscus/html-bundler-webpack-plugin/tree/master/docs/Options/PluginOptions/preprocessor.mdx","tags":[],"version":"current","sidebarPosition":130,"frontMatter":{"sidebar_position":130,"title":"preprocessor (for templates)"},"sidebar":"docsSidebar","previous":{"title":"beforePreprocessor (for templates)","permalink":"/html-bundler-webpack-plugin/Options/PluginOptions/beforePreprocessor"},"next":{"title":"preprocessorOptions","permalink":"/html-bundler-webpack-plugin/Options/PluginOptions/preprocessorOptions"}}');var t=s(4848),o=s(8453);const i={sidebar_position:130,title:"preprocessor (for templates)"},c="Processing templates",l={},a=[{value:"Templating engines supported &quot;out of the box&quot;",id:"templating-engines-supported-out-of-the-box",level:3},{value:"Custom templating engine",id:"custom-templating-engine",level:3},{value:"Disable templating engine",id:"disable-templating-engine",level:3}];function d(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",br:"br",code:"code",h1:"h1",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"processing-templates",children:"Processing templates"})}),"\n",(0,t.jsxs)(n.p,{children:["Option: ",(0,t.jsx)(n.code,{children:"preprocessor"}),(0,t.jsx)(n.br,{}),"\n","Affects: Template"]}),"\n",(0,t.jsx)(n.p,{children:"Type:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"type Preprocessor =\n  | false\n  | 'eta'\n  | 'ejs'\n  | 'handlebars'\n  | 'nunjucks'\n  | 'pug'\n  | 'twig'\n  | ((\n      content: string,\n      loaderContext: LoaderContext<Object> & { data: { [key: string]: any } | string }\n    ) => string | Promise<any> | undefined);\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Default: ",(0,t.jsx)(n.code,{children:"'eta'"})]}),"\n",(0,t.jsxs)(n.p,{children:["You can use the preprocessor as a ",(0,t.jsx)(n.code,{children:"string"})," for supported template engines,\nor define your own preprocessor as a function to use any template engine."]}),"\n",(0,t.jsx)(n.h3,{id:"templating-engines-supported-out-of-the-box",children:'Templating engines supported "out of the box"'}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"type Preprocessor = 'eta' | 'ejs' | 'handlebars' | 'nunjucks' | 'pug' | 'twig';\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The preprocessor is ready to use the most popular templating engines:\n",(0,t.jsx)(n.a,{href:"#using-template-eta",children:"Eta"}),", ",(0,t.jsx)(n.a,{href:"#using-template-ejs",children:"EJS"}),", ",(0,t.jsx)(n.a,{href:"#using-template-handlebars",children:"Handlebars"}),", ",(0,t.jsx)(n.a,{href:"#using-template-nunjucks",children:"Nunjucks"}),", ",(0,t.jsx)(n.a,{href:"#using-template-pug",children:"Pug"}),", ",(0,t.jsx)(n.a,{href:"#using-template-twig",children:"Twig"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Defaults used the ",(0,t.jsx)(n.a,{href:"https://eta.js.org",children:"Eta"})," templating engine,\nbecause ",(0,t.jsx)(n.code,{children:"Eta"})," has the ",(0,t.jsx)(n.code,{children:"EJS"}),"-like syntax, is only ",(0,t.jsx)(n.code,{children:"2KB"})," gzipped and is much fasted than EJS.\nThe npm package ",(0,t.jsx)(n.code,{children:"eta"})," is already installed with this plugin."]}),"\n",(0,t.jsxs)(n.p,{children:["You can pass a custom options of the templating engine using the ",(0,t.jsx)(n.a,{href:"#loader-option-preprocessorOptions",children:"preprocessorOptions"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["For example, if you have ",(0,t.jsx)(n.code,{children:"EJS"})," templates:"]}),"\n",(0,t.jsxs)(n.p,{children:["install npm package ",(0,t.jsx)(n.code,{children:"ejs"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"npm i -D ejs\n"})}),"\n",(0,t.jsxs)(n.p,{children:["define the ",(0,t.jsx)(n.code,{children:"preprocessor"})," as the ",(0,t.jsx)(n.code,{children:"'ejs'"})," string"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"const HtmlBundlerPlugin = require('html-bundler-webpack-plugin');\nmodule.exports = {\n  plugins: [\n    new HtmlBundlerPlugin({\n      entry: {\n        index: 'src/views/home.ejs',\n      },\n      preprocessor: 'ejs',\n      preprocessorOptions: {...}\n    }),\n  ],\n};\n"})}),"\n",(0,t.jsx)(n.h3,{id:"custom-templating-engine",children:"Custom templating engine"}),"\n",(0,t.jsxs)(n.p,{children:["To use any templating engine, you can define the ",(0,t.jsx)(n.code,{children:"preprocessor"})," as a function."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"type Preprocessor = (\n  content: string,\n  loaderContext: LoaderContext<Object> & { data: { [key: string]: any } | string }\n) => string | Promise<any> | undefined;\n"})}),"\n",(0,t.jsx)(n.p,{children:"The function arguments:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"content"})," - a raw content of a template file defined in the ",(0,t.jsx)(n.a,{href:"#option-entry",children:(0,t.jsx)(n.code,{children:"entry"})})," option."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"loaderContext"})," - the ",(0,t.jsx)(n.a,{href:"https://webpack.js.org/api/loaders/#the-loader-context",children:"Loader Context"})," object contained useful properties:"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"mode: string"})," - a Webpack mode: ",(0,t.jsx)(n.code,{children:"production"}),", ",(0,t.jsx)(n.code,{children:"development"}),", ",(0,t.jsx)(n.code,{children:"none"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"rootContext: string"})," - a path to Webpack context"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"resource: string"})," - a template file, including query"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"resourcePath: string"})," - a template file"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"data: object|null"})," - variables passed in ",(0,t.jsx)(n.a,{href:"#option-entry",children:(0,t.jsx)(n.code,{children:"entry.{page}.data"})})," and ",(0,t.jsx)(n.a,{href:"#loader-option-data",children:(0,t.jsx)(n.code,{children:"loader.data"})})]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["The preprocessor is called for each entry file, before processing of the content.\nThe function can be used to compile the template with any template engine,\nsuch as ",(0,t.jsx)(n.a,{href:"https://eta.js.org",children:"Eta"}),", ",(0,t.jsx)(n.a,{href:"https://ejs.co",children:"EJS"}),", ",(0,t.jsx)(n.a,{href:"https://handlebarsjs.com",children:"Handlebars"}),", ",(0,t.jsx)(n.a,{href:"https://github.com/janl/mustache.js",children:"Mustache"}),", ",(0,t.jsx)(n.a,{href:"https://mozilla.github.io/nunjucks",children:"Nunjucks"}),", ",(0,t.jsx)(n.a,{href:"https://github.com/harttle/liquidjs",children:"LiquidJS"}),", etc."]}),"\n",(0,t.jsxs)(n.p,{children:["Returns new content as a ",(0,t.jsx)(n.code,{children:"string"})," for sync or ",(0,t.jsx)(n.code,{children:"Promise"})," for async processing.\nWhen the function returns ",(0,t.jsx)(n.code,{children:"undefined"}),", the contents of the template will not change."]}),"\n",(0,t.jsxs)(n.p,{children:["The example for your own ",(0,t.jsx)(n.code,{children:"sync"})," render function:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"{\n  preprocessor: (content, { data }) => render(content, data);\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The example of using ",(0,t.jsx)(n.code,{children:"Promise"})," for your own ",(0,t.jsx)(n.code,{children:"async"})," render function:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"{\n  preprocessor: (content, { data }) =>\n    new Promise((resolve) => {\n      const result = render(content, data);\n      resolve(result);\n    });\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The default ",(0,t.jsx)(n.code,{children:"preprocessor"})," is pre-configured as the following function:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"const { Eta } = require('eta');\nconst eta = new Eta({\n  async: false, // defaults is false, when is true then must be used `await includeAsync()`\n  useWith: true, // allow to use variables in template without `it.` scope\n  views: process.cwd(), // directory that contains templates\n});\npreprocessor = (content, { data }) => eta.renderString(content, data);\n"})}),"\n",(0,t.jsx)(n.h3,{id:"disable-templating-engine",children:"Disable templating engine"}),"\n",(0,t.jsxs)(n.p,{children:["You can use this plugin to resolve all source asset files in any ",(0,t.jsx)(n.code,{children:"HTML"}),"-like template used by server-side rendering.\nIn this case, disable the preprocessor.\nThe plugin resolves all source files and replaces them with the output filenames.\nThe original template remains unchanged except for the filenames being replaced."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"{\n  preprocessor: false,\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["See ",(0,t.jsx)(n.a,{href:"#recipe-preprocessor-php",children:"How to process a PHP template"}),"."]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"preprocessor"})," option is the reference to ",(0,t.jsx)(n.code,{children:"loaderOptions.preprocessor"}),".",(0,t.jsx)(n.br,{}),"\n","The ",(0,t.jsx)(n.code,{children:"preprocessorOptions"})," option is the reference to ",(0,t.jsx)(n.code,{children:"loaderOptions.preprocessorOptions"}),"."]})}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>c});var r=s(6540);const t={},o=r.createContext(t);function i(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);